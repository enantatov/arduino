# Coffee Machine Control with Arduino

Этот проект представляет собой систему управления кофемашиной с использованием Arduino. Проект включает управление термисторами, насосом, проточным датчиком и кнопками для выполнения различных функций кофемашины.

## Основные компоненты и их функции

- **Термисторы**: Измеряют температуру бойлера и парогенератора.
- **Проточный датчик**: Измеряет количество воды, протекающей через систему.
- **Насос**: Обеспечивает подачу воды в систему.
- **Кнопки**: Управляют различными функциями кофемашины.

## Подключение компонентов

- **Термисторы**:
  - **A0**: Термистор на 50 кОм через 10 кОм резистор для бойлера.
  - **A1**: Термистор на 50 кОм через 10 кОм резистор для капучинатора/парогенератора.

- **Микроконтроллер капучинатора**: Подключен к пину 2.
- **Реле**:
  - **Реле помпы воды**: Подключено к пину 3.
  - **Реле бойлера**: Подключено к пину 4.
  - **Реле клапана, перекрывающего воду на парогенератор**: Подключено к пину 5.
  - **Реле парогенератора**: Подключено к пину 6.

- **Датчик воды в баке**: Подключен к пину 7.

- **Кнопки**:
  - **Первая кнопка (BTN1_PIN, пин 8)**:
    - Короткое нажатие: приготовление эспрессо.
    - Два коротких нажатия: приготовление двойного эспрессо.
    - Длинное нажатие: выдача кипятка.
  - **Вторая кнопка (BTN2_PIN, пин 9)**:
    - Короткое нажатие: приготовление капучино.
    - Два коротких нажатия: приготовление двойного капучино.
    - Длинное нажатие: выдача молочной пены.
  - **Третья кнопка (BTN3_PIN, пин 10)**:
    - Короткое нажатие: приготовление латте.
    - Два коротких нажатия: приготовление двойного латте.
    - Длинное нажатие: промывка системы.

## Описание функций

### Обработка кнопок

Проект использует библиотеку GyverButton для обработки нажатий кнопок. Каждая кнопка поддерживает три типа нажатий: короткое нажатие, двойное короткое нажатие и длинное нажатие.

### Контроль температуры

Температура бойлера и парогенератора измеряется каждые 1000 мс. Если температура бойлера достигает 110 °C, бойлер выключается. Если температура падает до 100 °C, бойлер включается.
Причина таких температур - вода внутри нагревается медленее, чем корпус бойлера

### Вспомогательные функции

- **boileronoff()**: Включает и выключает бойлер в зависимости от температуры.
- **checkMilk()**: Проверяет наличие капучинатора.
- **flowmeter()**: Проверяет наличие воды в системе.
- **heatSteamer()**: Нагревает парогенератор до необходимой температуры.
- **makeCoffee(int pumpDelay)**: Управляет процессом приготовления кофе.
- **makeMilkFoam(int foamDelay)**: Управляет процессом приготовления молочной пены.
- **checkTemperature(unsigned long currentMillis)**: Проверяет и обновляет температуру бойлера и парогенератора.

### Функции обработки нажатий кнопок

- **handleButton(GButton &button, int buttonNumber)**: Обрабатывает нажатия кнопок.
- **handleSingleClick(int buttonNumber)**: Обрабатывает одинарные нажатия.
- **handleDoubleClick(int buttonNumber)**: Обрабатывает двойные нажатия.
- **handleLongPress(int buttonNumber)**: Обрабатывает длинные нажатия.

### Примеры функций

- **function1()**: Приготовление эспрессо.
- **function2()**: Приготовление капучино.
- **function3()**: Приготовление латте.
- **function4()**: Приготовление двойного эспрессо.
- **function5()**: Приготовление двойного капучино.
- **function6()**: Приготовление двойного латте.
- **function7()**: Выдача кипятка.
- **function8()**: Приготовление молочной пены.
- **function9()**: Промывка системы.

## Используемые библиотеки

- **GyverButton**: Для обработки нажатий кнопок.
 
## Установка и настройка

1. Подключите компоненты к Arduino согласно схеме.
2. Загрузите код в Arduino.
3. Настройте параметры времени и температуры в коде в соответствии с вашими требованиями.

---

 
